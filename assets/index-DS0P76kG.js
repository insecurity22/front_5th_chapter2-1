(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();const N={QUANTITY:10},c={LUCKY:{DISCOUNT_RATE:.8,PROBABILITY:.3,INITIAL_DELAY:10*1e3,INTERVAL:30*1e3},RECOMMENDED:{DISCOUNT_RATE:.95,INITIAL_DELAY:20*1e3,INTERVAL:60*1e3},BULK:{DISCOUNT_RATE:.25,QUANTITY:30},TUESDAY:{DISCOUNT_RATE:.1}},m=[{id:"p1",name:"상품1",price:1e4,stock:50,discount:.1},{id:"p2",name:"상품2",price:2e4,stock:30,discount:.15},{id:"p3",name:"상품3",price:3e4,stock:20,discount:.2},{id:"p4",name:"상품4",price:15e3,stock:0,discount:.05},{id:"p5",name:"상품5",price:25e3,stock:10,discount:.25}];let p,r,d,u,f,C,L=0,l=0,I=0;const g=5;function O(){let e=document.getElementById("app"),t=document.createElement("h1");t.className="text-2xl font-bold mb-4",t.textContent="장바구니";let s=document.createElement("div");s.className="bg-gray-100 p-8",p=document.createElement("div"),p.id="cart-items",r=document.createElement("div"),r.id="cart-total",r.className="text-xl font-bold my-4",d=document.createElement("select"),d.id="product-select",d.className="border rounded p-2 mr-2",u=document.createElement("button"),u.id="add-to-cart",u.className="bg-blue-500 text-white px-4 py-2 rounded",u.textContent="추가",f=document.createElement("div"),f.id="stock-status",f.className="text-sm text-gray-500 mt-2";let i=document.createElement("div");i.className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",i.appendChild(t),i.appendChild(p),i.appendChild(r),i.appendChild(d),i.appendChild(u),i.appendChild(f),T(),s.appendChild(i),e.appendChild(s),h(),setTimeout(function(){setInterval(function(){let n=m[Math.floor(Math.random()*m.length)];const o=n.stock>0;Math.random()<c.LUCKY.PROBABILITY&&o&&(n.price=Math.round(n.price*c.LUCKY.DISCOUNT_RATE),alert(`번개세일! ${n.name}이(가) 20% 할인 중입니다!`),T())},c.LUCKY.INTERVAL)},Math.random()*c.LUCKY.INITIAL_DELAY),setTimeout(function(){setInterval(function(){if(C){let n=m.find(function(o){return o.id!==C&&o.stock>0});n&&(alert(`${n.name}은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!`),n.price=Math.round(n.price*c.RECOMMENDED.DISCOUNT_RATE),T())}},c.RECOMMENDED.INTERVAL)},Math.random()*c.RECOMMENDED.INITIAL_DELAY)}function T(){d.innerHTML="",m.forEach(function(e){let t=document.createElement("option");t.value=e.id,t.textContent=`${e.name} - ${e.price}원`,e.stock===0&&(t.disabled=!0),d.appendChild(t)})}function h(){I=0,l=0;let e=0,t=p.children;Array.from(t).forEach(function(o){let a=x(o.id),E=parseInt(o.querySelector("span").textContent.split("x ")[1]),y=a.price*E,A=0;I+=E,e+=y,E>=N.QUANTITY&&(A=a.discount),l+=y*(1-A)});let s=0;if(I>=c.BULK.QUANTITY){let o=l*c.BULK.DISCOUNT_RATE,a=e-l;o>a?(l=e*(1-c.BULK.DISCOUNT_RATE),s=c.BULK.DISCOUNT_RATE):s=(e-l)/e}else s=(e-l)/e;if(new Date().getDay()===2&&(l*=1-c.TUESDAY.DISCOUNT_RATE,s=Math.max(s,c.TUESDAY.DISCOUNT_RATE)),r.textContent=`총액: ${Math.round(l)}원`,s>0){let o=document.createElement("span");o.className="text-green-500 ml-2",o.textContent=`(${(s*100).toFixed(1)}% 할인 적용)`,r.appendChild(o)}S(),D()}function S(){let e="";m.forEach(function(t){if(t.stock<g){const i=t.stock===0;e+=`${t.name}: ${i?"품절":`재고 부족 (${t.stock}개 남음)`}
`}}),f.textContent=e}const D=()=>{L=Math.floor(l/1e3);let e=document.getElementById("loyalty-points");e||(e=document.createElement("span"),e.id="loyalty-points",e.className="text-blue-500 ml-2",r.appendChild(e)),e.textContent=`(포인트: ${L})`};O();function x(e){return m.find(function(t){return t.id===e})}u.addEventListener("click",function(){let e=d.value,t=x(e);if(t&&t.stock>0){let s=document.getElementById(t.id);if(s){let i=parseInt(s.querySelector("span").textContent.split("x ")[1])+1;i<=t.stock?(s.querySelector("span").textContent=`${t.name} - ${t.price}원 x ${i}`,t.stock--):alert("재고가 부족합니다.",t.stock)}else{let i=document.createElement("div");i.id=t.id,i.className="flex justify-between items-center mb-2",i.innerHTML=`<span>${t.name} - ${t.price}원 x 1</span><div><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="-1">-</button><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="${t.id}" data-change="1">+</button><button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="${t.id}">삭제</button></div>`,p.appendChild(i),t.stock--}h(),C=e}});p.addEventListener("click",function(e){let t=e.target;if(t.classList.contains("quantity-change")||t.classList.contains("remove-item")){let s=t.dataset.productId,i=document.getElementById(s),n=x(s);if(t.classList.contains("quantity-change")){let o=parseInt(t.dataset.change),a=parseInt(i.querySelector("span").textContent.split("x ")[1])+o;a>0&&a<=n.stock+parseInt(i.querySelector("span").textContent.split("x ")[1])?(i.querySelector("span").textContent=`${i.querySelector("span").textContent.split("x ")[0]}x ${a}`,n.stock-=o):a<=0?(i.remove(),n.stock-=o):alert("재고가 부족합니다.")}else if(t.classList.contains("remove-item")){let o=parseInt(i.querySelector("span").textContent.split("x ")[1]);n.stock+=o,i.remove()}h()}});
